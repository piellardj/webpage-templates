var Page;!function(e){!function(t){function r(e,t,r){return Math.max(t,Math.min(r,e))}function n(e,t,n){return r(Math.round(e),t,n)}function i(e,t){return(e%t+t)%t}var o;!function(e){function t(e){var t=e.toString(16).toUpperCase();return 2===t.length?t:"0"+t}e.parseHexa=function(e){return/^#[0-9a-fA-F]{6}$/.test(e)?e.toUpperCase():null},e.hsvToRgb=function(e){var t,r=e.h/60,o=e.s*e.v,a=o*(1-Math.abs(i(r,2)-1));t=r<=1?{r:o,g:a,b:0}:r<=2?{r:a,g:o,b:0}:r<=3?{r:0,g:o,b:a}:r<=4?{r:0,g:a,b:o}:r<=5?{r:a,g:0,b:o}:{r:o,g:0,b:a};var u=e.v-o;return t.r=n(255*(t.r+u),0,255),t.g=n(255*(t.g+u),0,255),t.b=n(255*(t.b+u),0,255),t},e.rgbToHsv=function(e){var t=e.r/255,r=e.g/255,n=e.b/255,o=Math.max(t,r,n),a=o-Math.min(t,r,n),u={h:0,s:0,v:o};return 0!==a&&(o===t?u.h=(r-n)/a%6*60:o===r?u.h=60*((n-t)/a+2):o===n&&(u.h=60*((t-r)/a+4))),0!==o&&(u.s=a/o),u.h=i(u.h,360),u},e.rgbToHex=function(e){return"#"+t(e.r)+t(e.g)+t(e.b)},e.hexToRgb=function(e){return{r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)}}}(o||(o={}));var a,u,l=function(){function e(e){var t=this;this.observers=[],this.element=e,this.id=e.id,this.colorPreview=e.querySelector(".color-preview"),this.colorPreviewText=e.querySelector(".color-value"),this.updateVisiblePart(),this.element.addEventListener("click",function(){s.assignPopup(t)})}return Object.defineProperty(e.prototype,"value",{get:function(){return this.element.dataset.currentColor},set:function(e){if(this.value!==e){this.element.dataset.currentColor=e,this.updateVisiblePart();for(var t=o.hexToRgb(e),r=0,n=this.observers;r<n.length;r++){(0,n[r])(t)}}},enumerable:!1,configurable:!0}),e.prototype.attachPopup=function(e){this.element.parentElement.appendChild(e)},e.prototype.updateVisiblePart=function(){var e=this.value;this.colorPreview.style.background=e,this.colorPreviewText.textContent=e},e}();!function(e){var t;e.getColorPickerById=function(r){return e.load(),t[r]||null},e.load=function(){void 0===t&&(t=function(){for(var e={},t=document.querySelectorAll(".color-picker[id]"),r=0;r<t.length;r++){var n=new l(t[r]);e[t[r].id]=n}return e}())}}(a||(a={})),function(t){var r="color-picker";t.storeState=function(t){e.Helpers.URL.setQueryParameter(r,t.id,t.value)},t.applyStoredState=function(){e.Helpers.URL.loopOnParameters(r,function(t,n){var i=a.getColorPickerById(t),u=o.parseHexa(n);i&&u?i.value=u:(console.log("Removing invalid query parameter '"+t+"="+n+"'."),e.Helpers.URL.removeQueryParameter(r,t))})}}(u||(u={}));var s=function(){function e(){var t=this;this.hsv={h:200,s:.75,v:.5},this.popupElement=e.buildElement("div",["popup","color-picker-popup"]),this.valueSaturationPicker=e.buildElement("div",["block","picker","value-saturation-picker"]),this.hueColorFilter=e.buildElement("span",["color-filter","outlined"]),this.valueSaturationPicker.appendChild(this.hueColorFilter);var i=e.buildElement("span",["color-filter","outlined"]);i.style.background="linear-gradient(to top, black, rgba(0,0,0,0))",this.valueSaturationPicker.appendChild(i),this.valueSaturationCursor=e.buildElement("span",["cursor"]),this.valueSaturationPicker.appendChild(this.valueSaturationCursor),this.popupElement.appendChild(this.valueSaturationPicker),this.huePicker=e.buildElement("div",["block","picker","hue-picker"]);var a=e.buildElement("span",["hue-bar"]);this.huePicker.appendChild(a),this.hueCursor=e.buildElement("span",["cursor"]),this.huePicker.appendChild(this.hueCursor),this.popupElement.appendChild(this.huePicker);var u=e.buildElement("div",["preview-block"]);this.previewColor=e.buildElement("div",["preview-color","outlined"]),this.previewColor.classList.add("block"),u.appendChild(this.previewColor);var l=e.buildElement("table",["block"]),s=e.buildPreviewText(l,"hexa"),p=e.buildElement("span");p.textContent="#",s.appendChild(p),this.previewHexaValue=document.createElement("input"),this.previewHexaValue.type="text",this.previewHexaValue.minLength=6,this.previewHexaValue.maxLength=6,this.previewHexaValue.size=6,this.previewHexaValue.pattern="[0-9a-fA-F]{6}",this.previewHexaValue.addEventListener("input",function(){var e="#"+t.previewHexaValue.value;if(o.parseHexa(e)){var r=o.hexToRgb(e),n=o.rgbToHsv(r);t.hsv.h=n.h,t.hsv.s=n.s,t.hsv.v=n.v,t.onInput()}}),s.appendChild(this.previewHexaValue),this.previewRgbValue=e.buildPreviewText(l,"rgb"),this.previewHslValue=e.buildPreviewText(l,"hsv"),u.appendChild(l),this.popupElement.appendChild(u),this.registerCursorEvent(this.huePicker,function(e){t.hsv.h=n(360*e.x,0,360),t.onInput()}),this.registerCursorEvent(this.valueSaturationPicker,function(n){t.hsv.s=r(n.x,0,1),t.hsv.v=r(1-n.y,0,1),t.onInput(),t.valueSaturationCursor.style.left=e.percentageString(n.x),t.valueSaturationCursor.style.top=e.percentageString(n.y)});var h=!1;this.popupElement.addEventListener("mousedown",function(){h=!0}),window.addEventListener("mouseup",function(e){!t.popupElement.contains(e.target)&&t.popupElement.parentElement&&!h&&t.popupElement.parentElement.removeChild(t.popupElement),h=!1})}return e.assignPopup=function(t){e.popup||(e.popup=new e),e.popup.attach(t)},e.prototype.updateAppearance=function(){var t=o.hsvToRgb(this.hsv),r=o.rgbToHex(t),n="rgb("+t.r+", "+t.g+", "+t.b+")",i="hsl("+Math.round(this.hsv.h)+", 100%, 50%)";this.hueColorFilter.style.background="linear-gradient(to right, white, "+i+")",this.hueCursor.style.background=i,this.valueSaturationCursor.style.background=n,this.previewColor.style.background=n,this.previewHexaValue.value=r.substring(1),this.previewRgbValue.textContent=t.r+", "+t.g+", "+t.b;var a=e.percentageString(this.hsv.s),u=e.percentageString(this.hsv.v);this.previewHslValue.textContent=Math.round(this.hsv.h)+"Â°, "+a+", "+u,this.hueCursor.style.left=e.percentageString(this.hsv.h/360),this.valueSaturationCursor.style.left=a,this.valueSaturationCursor.style.top=e.percentageString(1-this.hsv.v)},e.prototype.onInput=function(){var e=o.hsvToRgb(this.hsv),t=o.rgbToHex(e);this.updateAppearance(),this.currentControl&&(this.currentControl.value=t),u.storeState(this.currentControl)},e.prototype.attach=function(t){this.currentControl=t;var r=t.value,n=o.hexToRgb(r),i=o.rgbToHsv(n);e.popup.hsv.h=i.h,e.popup.hsv.v=i.v,e.popup.hsv.s=i.s,e.popup.updateAppearance(),this.popupElement.style.top="",this.popupElement.style.left="",this.currentControl.attachPopup(this.popupElement),this.fitPopupToContainer()},e.prototype.fitPopupToContainer=function(){if(this.popupElement.parentElement){var e=(document.querySelector(".controls-block")||document.body).getBoundingClientRect(),t=e.left+e.width-16,r=e.top+e.height-16;this.popupElement.style.maxWidth=e.width-32+"px",this.popupElement.style.maxHeight=e.height-32+"px";var n=this.popupElement.parentElement.getBoundingClientRect(),i=this.popupElement.getBoundingClientRect(),o=Math.max(0,e.left+16-n.left),a=Math.min(0,t-(n.left+i.width)),u=Math.max(0,e.top+16-n.top),l=Math.min(0,r-(n.top+i.height));this.popupElement.style.left=o+a+"px",this.popupElement.style.top=u+l+"px"}},e.prototype.registerCursorEvent=function(e,t){function r(t,r){var n=e.getBoundingClientRect(),i=(t-n.left)/n.width,o=(r-n.top)/n.height;return{x:Math.max(0,Math.min(1,i)),y:Math.max(0,Math.min(1,o))}}var n=e.querySelector(".cursor"),i={x:0,y:0},o=!1;e.addEventListener("mousedown",function(e){if(o=!0,i.x=0,i.y=0,n&&e.target===n){var a=n.getBoundingClientRect();i.x=.5*a.width-(e.clientX-a.left),i.y=.5*a.height-(e.clientY-a.top)}else{var u=r(e.clientX,e.clientY);t(u)}}),window.addEventListener("mouseup",function(){o=!1}),window.addEventListener("mousemove",function(e){if(o){var n=r(e.clientX+i.x,e.clientY+i.y);t(n)}});var a=[];e.addEventListener("touchstart",function(e){o=!0;for(var n=0===a.length,i=0;i<e.changedTouches.length;++i){for(var u=e.changedTouches[i],l=!1,s=0,p=a;s<p.length;s++){var h=p[s];if(u.identifier===h){l=!0;break}}l||a.push(u.identifier)}if(n&&a.length>0){var c=r(e.changedTouches[0].clientX,e.changedTouches[0].clientY);t(c)}},!1),window.addEventListener("touchend",function(e){for(var t=a.length>0,r=0;r<e.changedTouches.length;++r)for(var n=e.changedTouches[r],i=0;i<a.length;++i)n.identifier===a[i]&&(a.splice(i,1),i--);t&&0===a.length&&(o=!1)}),window.addEventListener("touchmove",function(e){if(a.length>0&&o)for(var n=e.changedTouches,i=0;i<n.length;++i)for(var u=n[i],l=0,s=a;l<s.length;l++){var p=s[l];if(u.identifier===p){var h=r(u.clientX,u.clientY);return t(h),void e.preventDefault()}}},{passive:!1})},e.buildElement=function(e,t){var r=document.createElement(e);return t&&(r.className=t.join(" ")),r},e.buildPreviewText=function(e,t){var r=document.createElement("tr"),n=document.createElement("td");n.textContent=t+":";var i=document.createElement("td");return r.appendChild(n),r.appendChild(i),e.appendChild(r),i},e.percentageString=function(e){return Math.round(100*e)+"%"},e}();e.Helpers.Events.callAfterDOMLoaded(function(){a.load(),u.applyStoredState()}),t.addObserver=function(e,t){var r=a.getColorPickerById(e);return r&&r.observers.push(t),!1},t.getValue=function(e){var t=a.getColorPickerById(e).value;return o.hexToRgb(t)},t.getValueHex=function(e){return a.getColorPickerById(e).value},t.setValue=function(e,t,r,i,l){void 0===l&&(l=!1);var s={r:n(t,0,255),g:n(r,0,255),b:n(i,0,255)},p=o.rgbToHex(s),h=a.getColorPickerById(e);h.value=p,l&&u.storeState(h)}}(e.ColorPicker||(e.ColorPicker={}))}(Page||(Page={}));