var Page;!function(f){!function(e){function a(e,t,n){return Math.max(t,Math.min(n,e))}function u(e,t,n){return a(Math.round(e),t,n)}function l(e,t){return(e%t+t)%t}var s;function t(e){e=e.toString(16).toUpperCase();return 2===e.length?e:"0"+e}(p=s=s||{}).parseHexa=function(e){return/^#[0-9a-fA-F]{6}$/.test(e)?e.toUpperCase():null},p.hsvToRgb=function(e){var t=e.h/60,n=(r=e.s*e.v)*(1-Math.abs(l(t,2)-1)),n=t<=1?{r:r,g:n,b:0}:t<=2?{r:n,g:r,b:0}:t<=3?{r:0,g:r,b:n}:t<=4?{r:0,g:n,b:r}:t<=5?{r:n,g:0,b:r}:{r:r,g:0,b:n},r=e.v-r;return n.r=u(255*(n.r+r),0,255),n.g=u(255*(n.g+r),0,255),n.b=u(255*(n.b+r),0,255),n},p.rgbToHsv=function(e){var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.max(t,n,r),o=i-Math.min(t,n,r),e={h:0,s:0,v:i};return 0!=o&&(i===t?e.h=(n-r)/o%6*60:i===n?e.h=60*((r-t)/o+2):i===r&&(e.h=60*((t-n)/o+4))),0!==i&&(e.s=o/i),e.h=l(e.h,360),e},p.rgbToHex=function(e){return"#"+t(e.r)+t(e.g)+t(e.b)},p.hexToRgb=function(e){return{r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)}};var i,n,r,o,p,h,c=(Object.defineProperty(d.prototype,"value",{get:function(){return this.element.dataset.currentColor},set:function(e){if(this.value!==e){this.element.dataset.currentColor=e,this.updateVisiblePart();for(var t=s.hexToRgb(e),n=0,r=this.observers;n<r.length;n++)(0,r[n])(t)}},enumerable:!1,configurable:!0}),d.prototype.attachPopup=function(e){this.element.parentElement.appendChild(e)},d.prototype.updateVisiblePart=function(){var e=this.value;this.colorPreview.style.background=e,this.colorPreviewText.textContent=e},d);function d(e){var t=this;this.observers=[],this.element=e,this.id=e.id,this.colorPreview=e.querySelector(".color-preview"),this.colorPreviewText=e.querySelector(".color-value"),this.updateVisiblePart(),this.element.addEventListener("click",function(){v.assignPopup(t)})}(n=i=i||{}).getColorPickerById=function(e){return n.load(),r[e]||null},n.load=function(){void 0===r&&(r=function(){for(var e={},t=document.querySelectorAll(".color-picker[id]"),n=0;n<t.length;n++){var r=new c(t[n]);e[t[n].id]=r}return e}())},p=o=o||{},h="color-picker",p.storeState=function(e){f.Helpers.URL.setQueryParameter(h,e.id,e.value)},p.clearStoredState=function(e){f.Helpers.URL.removeQueryParameter(h,e.id)},p.applyStoredState=function(){f.Helpers.URL.loopOnParameters(h,function(e,t){var n=i.getColorPickerById(e),r=s.parseHexa(t);n&&r?n.value=r:(console.log("Removing invalid query parameter '"+e+"="+t+"'."),f.Helpers.URL.removeQueryParameter(h,e))})};var v=(g.assignPopup=function(e){g.popup||(g.popup=new g),g.popup.attach(e)},g.prototype.updateAppearance=function(){var e=s.hsvToRgb(this.hsv),t=s.rgbToHex(e),n="rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")"),r="hsl(".concat(Math.round(this.hsv.h),", 100%, 50%)");this.hueColorFilter.style.background="linear-gradient(to right, white, ".concat(r,")"),this.hueCursor.style.background=r,this.valueSaturationCursor.style.background=n,this.previewColor.style.background=n,this.previewHexaValue.value=t.substring(1),this.previewRgbValue.textContent="".concat(e.r,", ").concat(e.g,", ").concat(e.b);t=g.percentageString(this.hsv.s),e=g.percentageString(this.hsv.v);this.previewHslValue.textContent="".concat(Math.round(this.hsv.h),"Â°, ").concat(t,", ").concat(e),this.hueCursor.style.left=g.percentageString(this.hsv.h/360),this.valueSaturationCursor.style.left=t,this.valueSaturationCursor.style.top=g.percentageString(1-this.hsv.v)},g.prototype.onInput=function(){var e=s.hsvToRgb(this.hsv),e=s.rgbToHex(e);this.updateAppearance(),this.currentControl&&(this.currentControl.value=e),o.storeState(this.currentControl)},g.prototype.attach=function(e){e=(this.currentControl=e).value,e=s.hexToRgb(e),e=s.rgbToHsv(e);g.popup.hsv.h=e.h,g.popup.hsv.v=e.v,g.popup.hsv.s=e.s,g.popup.updateAppearance(),this.popupElement.style.top="",this.popupElement.style.left="",this.currentControl.attachPopup(this.popupElement),this.fitPopupToContainer()},g.prototype.fitPopupToContainer=function(){var e,t,n,r,i,o;this.popupElement.parentElement&&(r=(i=(document.querySelector(".controls-block")||document.body).getBoundingClientRect()).left+i.width-16,e=i.top+i.height-16,this.popupElement.style.maxWidth=i.width-32+"px",this.popupElement.style.maxHeight=i.height-32+"px",t=this.popupElement.parentElement.getBoundingClientRect(),o=this.popupElement.getBoundingClientRect(),n=Math.max(0,i.left+16-t.left),r=Math.min(0,r-(t.left+o.width)),i=Math.max(0,i.top+16-t.top),o=Math.min(0,e-(t.top+o.height)),this.popupElement.style.left=n+r+"px",this.popupElement.style.top=i+o+"px")},g.prototype.registerCursorEvent=function(r,l){function s(e,t){var n=r.getBoundingClientRect(),e=(e-n.left)/n.width,n=(t-n.top)/n.height;return{x:Math.max(0,Math.min(1,e)),y:Math.max(0,Math.min(1,n))}}var n=r.querySelector(".cursor"),i={x:0,y:0},p=!1;r.addEventListener("mousedown",function(e){var t;p=!0,i.x=0,i.y=0,n&&e.target===n?(t=n.getBoundingClientRect(),i.x=.5*t.width-(e.clientX-t.left),i.y=.5*t.height-(e.clientY-t.top)):(e=s(e.clientX,e.clientY),l(e))}),window.addEventListener("mouseup",function(){p=!1}),window.addEventListener("mousemove",function(e){p&&(e=s(e.clientX+i.x,e.clientY+i.y),l(e))});var h=[];r.addEventListener("touchstart",function(e){p=!0;for(var t=0===h.length,n=0;n<e.changedTouches.length;++n){for(var r=e.changedTouches[n],i=!1,o=0,a=h;o<a.length;o++){var u=a[o];if(r.identifier===u){i=!0;break}}i||h.push(r.identifier)}t&&0<h.length&&(t=s(e.changedTouches[0].clientX,e.changedTouches[0].clientY),l(t))},!1),window.addEventListener("touchend",function(e){for(var t=0<h.length,n=0;n<e.changedTouches.length;++n)for(var r=e.changedTouches[n],i=0;i<h.length;++i)r.identifier===h[i]&&(h.splice(i,1),i--);t&&0===h.length&&(p=!1)}),window.addEventListener("touchmove",function(e){if(0<h.length&&p)for(var t=e.changedTouches,n=0;n<t.length;++n)for(var r=t[n],i=0,o=h;i<o.length;i++){var a=o[i];if(r.identifier===a){a=s(r.clientX,r.clientY);return l(a),void e.preventDefault()}}},{passive:!1})},g.buildElement=function(e,t){e=document.createElement(e);return t&&(e.className=t.join(" ")),e},g.buildPreviewText=function(e,t){var n=document.createElement("tr"),r=document.createElement("td");r.textContent=t+":";t=document.createElement("td");return n.appendChild(r),n.appendChild(t),e.appendChild(n),t},g.percentageString=function(e){return Math.round(100*e)+"%"},g);function g(){var t=this;this.hsv={h:200,s:.75,v:.5},this.popupElement=g.buildElement("div",["popup","color-picker-popup"]),this.valueSaturationPicker=g.buildElement("div",["block","picker","value-saturation-picker"]),this.hueColorFilter=g.buildElement("span",["color-filter","outlined"]),this.valueSaturationPicker.appendChild(this.hueColorFilter);var e=g.buildElement("span",["color-filter","outlined"]);e.style.background="linear-gradient(to top, black, rgba(0,0,0,0))",this.valueSaturationPicker.appendChild(e),this.valueSaturationCursor=g.buildElement("span",["cursor"]),this.valueSaturationPicker.appendChild(this.valueSaturationCursor),this.popupElement.appendChild(this.valueSaturationPicker),this.huePicker=g.buildElement("div",["block","picker","hue-picker"]);var n=g.buildElement("span",["hue-bar"]);this.huePicker.appendChild(n),this.hueCursor=g.buildElement("span",["cursor"]),this.huePicker.appendChild(this.hueCursor),this.popupElement.appendChild(this.huePicker);var r=g.buildElement("div",["preview-block"]);this.previewColor=g.buildElement("div",["preview-color","outlined"]),this.previewColor.classList.add("block"),r.appendChild(this.previewColor);var i=g.buildElement("table",["block"]),e=g.buildPreviewText(i,"hexa"),n=g.buildElement("span");n.textContent="#",e.appendChild(n),this.previewHexaValue=document.createElement("input"),this.previewHexaValue.type="text",this.previewHexaValue.minLength=6,this.previewHexaValue.maxLength=6,this.previewHexaValue.size=6,this.previewHexaValue.pattern="[0-9a-fA-F]{6}",this.previewHexaValue.addEventListener("input",function(){var e="#"+t.previewHexaValue.value;s.parseHexa(e)&&(e=s.hexToRgb(e),e=s.rgbToHsv(e),t.hsv.h=e.h,t.hsv.s=e.s,t.hsv.v=e.v,t.onInput())}),e.appendChild(this.previewHexaValue),this.previewRgbValue=g.buildPreviewText(i,"rgb"),this.previewHslValue=g.buildPreviewText(i,"hsv"),r.appendChild(i),this.popupElement.appendChild(r),this.registerCursorEvent(this.huePicker,function(e){t.hsv.h=u(360*e.x,0,360),t.onInput()}),this.registerCursorEvent(this.valueSaturationPicker,function(e){t.hsv.s=a(e.x,0,1),t.hsv.v=a(1-e.y,0,1),t.onInput(),t.valueSaturationCursor.style.left=g.percentageString(e.x),t.valueSaturationCursor.style.top=g.percentageString(e.y)});var o=!1;this.popupElement.addEventListener("mousedown",function(){o=!0}),window.addEventListener("mouseup",function(e){t.popupElement.contains(e.target)||!t.popupElement.parentElement||o||t.popupElement.parentElement.removeChild(t.popupElement),o=!1})}f.Helpers.Events.callAfterDOMLoaded(function(){i.load(),o.applyStoredState()}),e.addObserver=function(e,t){return(e=i.getColorPickerById(e))&&e.observers.push(t),!1},e.getValue=function(e){return e=i.getColorPickerById(e).value,s.hexToRgb(e)},e.getValueHex=function(e){return i.getColorPickerById(e).value},e.setValue=function(e,t,n,r){r={r:u(t,0,255),g:u(n,0,255),b:u(r,0,255)},r=s.rgbToHex(r),i.getColorPickerById(e).value=r},e.storeState=function(e){e=i.getColorPickerById(e),o.storeState(e)},e.clearStoredState=function(e){e=i.getColorPickerById(e),o.clearStoredState(e)}}(f.ColorPicker||(f.ColorPicker={}))}(Page=Page||{});