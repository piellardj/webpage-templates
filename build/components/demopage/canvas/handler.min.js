var Page;!function(t){var n,o,i,U,c,r,a,u,s,l,d,f,h,v,g,m,p,y,E,w,e,L,k,M,C,b,S,Y,x,z,X,D,q,B,P;function I(e){var n=document.querySelector(e);return n||console.error("Cannot find element '"+e+"'."),n}function O(e){return I("input[type=checkbox][id="+e+"]")}function A(e){document.body.style.overflow=e?"hidden":"auto"}function R(){var e=i.getBoundingClientRect();return[Math.floor(e.width),Math.floor(e.height)]}function F(e){return e+"px"}function T(){o.style.width="100vw";var e=R();if(c.checked?(o.style.height="100%",o.style.maxWidth="",o.style.maxHeight=""):(e[1]=e[0]*s/u,o.style.height=F(e[1]),o.style.maxWidth=F(u),o.style.maxHeight=F(s)),e[0]!==l[0]||e[1]!==l[1]){l=R();for(var n=0,t=d;n<t.length;n++)(0,t[n])(l[0],l[1])}}function H(e,n){var t=i.getBoundingClientRect();return[(e-t.left)/t.width,(n-t.top)/t.height]}function Q(e,n){h[0]=e,h[1]=n}function W(e,n){e=H(e,n);Q(e[0],e[1]),g=!0;for(var t=0,o=x;t<o.length;t++)(0,o[t])()}function V(){if(g){g=!1;for(var e=0,n=z;e<n.length;e++)(0,n[e])()}}function j(e,n){var t=H(v[0]=e,v[1]=n),o=t[0]-h[0],i=t[1]-h[1];if(h[0]=t[0],h[1]=t[1],g)for(var c=0,r=X;c<r.length;c++)(0,r[c])(o,i);for(var a=0,u=D;a<u.length;a++)(0,u[a])(t[0],t[1])}function G(e,n){var t=e.clientX-n.clientX,e=e.clientY-n.clientY;return Math.sqrt(t*t+e*e)}function J(e,n){t.Helpers.URL.setQueryParameter(k,e,n?b:S)}n=t.Canvas||(t.Canvas={}),o=document.getElementById("canvas-container"),i=I("canvas[id=canvas]"),U=document.getElementById("canvas-buttons-column"),c=O("fullscreen-checkbox-id"),r=O("side-pane-checkbox-id"),a=o.querySelector(".loader"),s=u=512,c&&(t.Helpers.Events.callAfterDOMLoaded(function(){A(c.checked),c.addEventListener("change",function(){A(c.checked)})}),r&&c.addEventListener("change",function(){c.checked&&(r.checked=!1)},!1)),l=[0,0],d=[],t.Helpers.Events.callAfterDOMLoaded(T),c.addEventListener("change",T,!1),window.addEventListener("resize",T,!1),Y=[T],x=[],z=[],X=[],D=[],q=[],B=[],P=[],c&&c.addEventListener("change",function(){for(var e=c.checked,n=0,t=Y;n<t.length;n++)(0,t[n])(e)},!1),document.addEventListener("keydown",function(e){27===e.keyCode&&n.toggleFullscreen(!1)}),L=f=f||{},h=[0,0],g=!(v=[0,0]),L.getMousePosition=function(){return[h[0],h[1]]},L.setMousePosition=Q,L.isMouseDown=function(){return g},L.mouseDown=W,L.mouseUp=V,L.mouseMove=j,i&&(i.addEventListener("mousedown",function(e){0===e.button&&W(e.clientX,e.clientY)},!1),i.addEventListener("mouseenter",function(){for(var e=0,n=q;e<n.length;e++)(0,n[e])()},!1),i.addEventListener("mouseleave",function(){for(var e=0,n=B;e<n.length;e++)(0,n[e])()},!1),i.addEventListener("wheel",function(e){if(0<P.length){for(var n=0<e.deltaY?1:-1,t=0,o=P;t<o.length;t++)(0,o[t])(n,h);return e.preventDefault(),!1}return!0},!1),window.addEventListener("mousemove",function(e){j(e.clientX,e.clientY)}),window.addEventListener("mouseup",function(e){0===e.button&&V()}),d.push(function(){j(v[0],v[1])})),m=[],p=0,i&&(i.addEventListener("touchstart",function(e){for(var n=0===m.length,t=0;t<e.changedTouches.length;++t){for(var o=e.changedTouches[t],i=!1,c=0,r=m;c<r.length;c++){var a=r[c];if(o.identifier===a.id){i=!0;break}}i||m.push({id:o.identifier,clientX:o.clientX,clientY:o.clientY})}n&&0<m.length?(n=m[0],f.mouseDown(n.clientX,n.clientY)):2===m.length&&(p=G(m[0],m[1]))},!1),window.addEventListener("touchend",function(e){for(var n,t=0<m.length,o=0;o<e.changedTouches.length;++o)for(var i=e.changedTouches[o],c=0;c<m.length;++c)i.identifier===m[c].id&&(m.splice(c,1),c--);1===m.length?(n=H(m[0].clientX,m[0].clientY),f.setMousePosition(n[0],n[1])):t&&0===m.length&&f.mouseUp()}),window.addEventListener("touchmove",function(e){for(var n=e.changedTouches,t=0;t<n.length;++t)for(var o=n[t],i=0,c=m;i<c.length;i++){var r=c[i];o.identifier===r.id&&(r.clientX=o.clientX,r.clientY=o.clientY)}var a=D.length+X.length;if(f.isMouseDown()&&0<a&&e.preventDefault(),1===m.length)f.mouseMove(m[0].clientX,m[0].clientY);else if(2===m.length){var a=G(m[0],m[1]),u=(p-a)/p;p=a;for(var s=H(.5*(m[0].clientX+m[1].clientX),.5*(m[0].clientY+m[1].clientY)),l=0,d=P;l<d.length;l++)(0,d[l])(5*u,s)}},{passive:!1})),L=y=y||{},E={},w="-indicator-id",L.getIndicator=function(e){return I("#"+e+w)},L.getIndicatorSpan=function(e){return E[e]||(E[e]=I("#"+(e+w)+" span")),E[e]},L=e=e||{},k="canvas",M="fullscreen",C="sidepane",b="true",S="false",L.attachStorageEvents=function(){c&&c.addEventListener("change",function(){J(M,c.checked),t.Helpers.URL.removeQueryParameter(k,C)}),r&&r.addEventListener("change",function(){J(C,r.checked)})},L.applyStoredState=function(){t.Helpers.URL.loopOnParameters(k,function(e,n){e!==M||n!==b&&n!==S?e!==C||n!==b&&n!==S?(console.log("Removing invalid query parameter '"+e+"="+n+"'."),t.Helpers.URL.removeQueryParameter(k,e)):r&&(r.checked=n===b):c&&(c.checked=n===b)})},e.applyStoredState(),e.attachStorageEvents(),n.Observers=Object.freeze({canvasResize:d,fullscreenToggle:Y,mouseDown:x,mouseDrag:X,mouseEnter:q,mouseLeave:B,mouseMove:D,mouseWheel:P,mouseUp:z}),n.getAspectRatio=function(){var e=R();return e[0]/e[1]},n.getCanvas=function(){return i},n.getCanvasContainer=function(){return o},n.getSize=R,n.getMousePosition=function(){return f.getMousePosition()},n.isFullScreen=function(){return c&&c.checked},n.isMouseDown=function(){return f.isMouseDown()},n.setIndicatorText=function(e,n){(e=y.getIndicatorSpan(e))&&(e.innerText=n)},n.setIndicatorVisibility=function(e,n){(e=y.getIndicator(e))&&(e.style.display=n?"":"none")},n.setIndicatorsVisibility=function(e){document.getElementById("indicators").style.display=e?"":"none"},n.setMaxSize=function(e,n){u=e,s=n,T()},n.setResizable=function(e){U.style.display=e?"":"none"},n.setLoaderText=function(e){a&&(a.querySelector("span").innerText=e)},n.showLoader=function(e){a&&(a.style.display=e?"block":"")},n.toggleFullscreen=function(e){c&&e!==c.checked&&(c.checked=e,"function"==typeof window.CustomEvent?c.dispatchEvent(new CustomEvent("change")):"function"==typeof CustomEvent.prototype.initCustomEvent&&((e=document.createEvent("CustomEvent")).initCustomEvent("change",!1,!1,void 0),c.dispatchEvent(e)))}}(Page=Page||{});