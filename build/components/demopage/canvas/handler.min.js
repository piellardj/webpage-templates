var Page;!function(h){var n,o,i,T,r,t,c,a,s,u,l,v,d,f,g,p,m,y,E,w,e,L,k,M,C,H,U,b,Y,x,S,X,z,A,D;function O(e){var n=document.querySelector(e);return n||console.error("Cannot find element '"+e+"'."),n}function q(e){return h.Helpers.Utils.selector(document,"input[type=checkbox][id="+e+"]")}function B(e){document.body.style.overflow=e?"hidden":"auto"}function P(){var e=i.getBoundingClientRect();return[Math.floor(e.width),Math.floor(e.height)]}function F(e){return e+"px"}function R(){o.style.width="100vw";var e=P();if(r.checked?(o.style.height="100%",o.style.maxWidth="",o.style.maxHeight=""):(e[1]=e[0]*s/a,o.style.height=F(e[1]),o.style.maxWidth=F(a),o.style.maxHeight=F(s)),e[0]!==u[0]||e[1]!==u[1]){u=P();for(var n=0,t=l;n<t.length;n++)(0,t[n])(u[0],u[1])}}function I(e,n){var t=i.getBoundingClientRect();return[(e-t.left)/t.width,(n-t.top)/t.height]}function Q(e,n){d[0]=e,d[1]=n}function W(e,n){e=I(e,n);Q(e[0],e[1]),g=!0;for(var t=0,o=Y;t<o.length;t++)(0,o[t])()}function V(){if(g){g=!1;for(var e=0,n=x;e<n.length;e++)(0,n[e])()}}function j(e,n){var t=I(f[0]=e,f[1]=n),o=t[0]-d[0],i=t[1]-d[1];if(d[0]=t[0],d[1]=t[1],g)for(var r=0,c=S;r<c.length;r++)(0,c[r])(o,i);for(var a=0,s=X;a<s.length;a++)(0,s[a])(t[0],t[1])}function G(e,n){var t=e.clientX-n.clientX,e=e.clientY-n.clientY;return Math.sqrt(t*t+e*e)}function J(e,n){h.Helpers.URL.setQueryParameter(k,e,n?H:U)}n=h.Canvas||(h.Canvas={}),o=h.Helpers.Utils.selector(document,"#canvas-container"),i=h.Helpers.Utils.selector(document,"canvas[id=canvas]"),T=h.Helpers.Utils.selector(document,"canvas-buttons-column"),r=q("fullscreen-checkbox-id"),t=q("side-pane-checkbox-id"),c=h.Helpers.Utils.selector(o,".loader"),s=a=512,r&&(h.Helpers.Events.callAfterDOMLoaded(function(){B(r.checked),r.addEventListener("change",function(){B(r.checked)})}),t&&r.addEventListener("change",function(){r.checked&&(t.checked=!1)},!1)),u=[0,0],l=[],h.Helpers.Events.callAfterDOMLoaded(R),r.addEventListener("change",R,!1),window.addEventListener("resize",R,!1),b=[R],Y=[],x=[],S=[],X=[],z=[],A=[],D=[],r&&r.addEventListener("change",function(){for(var e=r.checked,n=0,t=b;n<t.length;n++)(0,t[n])(e)},!1),document.addEventListener("keydown",function(e){27===e.keyCode&&n.toggleFullscreen(!1)}),L=v=v||{},d=[0,0],g=!(f=[0,0]),L.getMousePosition=function(){return[d[0],d[1]]},L.setMousePosition=Q,L.isMouseDown=function(){return g},L.mouseDown=W,L.mouseUp=V,L.mouseMove=j,i&&(i.addEventListener("mousedown",function(e){0===e.button&&W(e.clientX,e.clientY)},!1),i.addEventListener("mouseenter",function(){for(var e=0,n=z;e<n.length;e++)(0,n[e])()},!1),i.addEventListener("mouseleave",function(){for(var e=0,n=A;e<n.length;e++)(0,n[e])()},!1),i.addEventListener("wheel",function(e){if(0<D.length){for(var n=0<e.deltaY?1:-1,t=0,o=D;t<o.length;t++)(0,o[t])(n,d);return e.preventDefault(),!1}return!0},!1),window.addEventListener("mousemove",function(e){j(e.clientX,e.clientY)}),window.addEventListener("mouseup",function(e){0===e.button&&V()}),l.push(function(){j(f[0],f[1])})),p=[],m=0,i&&(i.addEventListener("touchstart",function(e){for(var n=0===p.length,t=0,o=h.Helpers.Utils.touchArray(e.changedTouches);t<o.length;t++){for(var i=o[t],r=!1,c=0,a=p;c<a.length;c++){var s=a[c];if(i.identifier===s.id){r=!0;break}}r||p.push({id:i.identifier,clientX:i.clientX,clientY:i.clientY})}n&&0<p.length?(e=p[0],v.mouseDown(e.clientX,e.clientY)):2===p.length&&(m=G(p[0],p[1]))},!1),window.addEventListener("touchend",function(e){for(var n=0<p.length,t=0,o=h.Helpers.Utils.touchArray(e.changedTouches);t<o.length;t++)for(var i=o[t],r=0;r<p.length;++r)i.identifier===p[r].id&&(p.splice(r,1),r--);1===p.length?(e=I((e=p[0]).clientX,e.clientY),v.setMousePosition(e[0],e[1])):n&&0===p.length&&v.mouseUp()}),window.addEventListener("touchmove",function(e){for(var n=0,t=h.Helpers.Utils.touchArray(e.changedTouches);n<t.length;n++)for(var o=t[n],i=0,r=p;i<r.length;i++){var c=r[i];o.identifier===c.id&&(c.clientX=o.clientX,c.clientY=o.clientY)}var a=X.length+S.length;if(v.isMouseDown()&&0<a&&e.preventDefault(),1===p.length){var s=p[0];v.mouseMove(s.clientX,s.clientY)}else if(2===p.length){var s=p[0],a=p[1],e=G(s,a),u=(m-e)/m;m=e;for(var l=I(.5*(s.clientX+a.clientX),.5*(s.clientY+a.clientY)),d=0,f=D;d<f.length;d++)(0,f[d])(5*u,l)}},{passive:!1})),L=y=y||{},E={},w="-indicator-id",L.getIndicator=function(e){var n=O("#"+e+w);if(n)return n;throw new Error("Could not find indicator '".concat(e,"'."))},L.getIndicatorSpan=function(e){if(!E[e]){var n=O("#"+(e+w)+" span");if(!n)throw new Error("Could not find indicator span '".concat(e,"'."));E[e]=n}return E[e]},L=e=e||{},k="canvas",M="fullscreen",C="sidepane",H="true",U="false",L.attachStorageEvents=function(){r&&r.addEventListener("change",function(){J(M,r.checked),h.Helpers.URL.removeQueryParameter(k,C)}),t&&t.addEventListener("change",function(){J(C,t.checked)})},L.applyStoredState=function(){h.Helpers.URL.loopOnParameters(k,function(e,n){e!==M||n!==H&&n!==U?e!==C||n!==H&&n!==U?(console.log("Removing invalid query parameter '"+e+"="+n+"'."),h.Helpers.URL.removeQueryParameter(k,e)):t&&(t.checked=n===H):r&&(r.checked=n===H)})},e.applyStoredState(),e.attachStorageEvents(),n.Observers=Object.freeze({canvasResize:l,fullscreenToggle:b,mouseDown:Y,mouseDrag:S,mouseEnter:z,mouseLeave:A,mouseMove:X,mouseWheel:D,mouseUp:x}),n.getAspectRatio=function(){var e=P();return e[0]/e[1]},n.getCanvas=function(){return i},n.getCanvasContainer=function(){return o},n.getSize=P,n.getMousePosition=function(){return v.getMousePosition()},n.isFullScreen=function(){return r&&r.checked},n.isMouseDown=function(){return v.isMouseDown()},n.setIndicatorText=function(e,n){(e=y.getIndicatorSpan(e))&&(e.innerText=n)},n.setIndicatorVisibility=function(e,n){(e=y.getIndicator(e))&&(e.style.display=n?"":"none")},n.setIndicatorsVisibility=function(e){document.getElementById("indicators").style.display=e?"":"none"},n.setMaxSize=function(e,n){a=e,s=n,R()},n.setResizable=function(e){T.style.display=e?"":"none"},n.setLoaderText=function(e){c&&(c.querySelector("span").innerText=e)},n.showLoader=function(e){c&&(c.style.display=e?"block":"")},n.toggleFullscreen=function(e){r&&e!==r.checked&&(r.checked=e,"function"==typeof window.CustomEvent?r.dispatchEvent(new CustomEvent("change")):"function"==typeof CustomEvent.prototype.initCustomEvent&&((e=document.createEvent("CustomEvent")).initCustomEvent("change",!1,!1,void 0),r.dispatchEvent(e)))}}(Page=Page||{});