const Canvas=function(){function e(e){const t=document.querySelector(e);return t||console.error("Cannot find element '"+e+"'."),t}function t(t){return e("input[type=checkbox][id="+t+"]")}const n=document.getElementById("canvas-container"),i=e("canvas[id="+"canvas"+"]");const c=document.getElementById("canvas-buttons-column"),o=t("fullscreen-checkbox-id"),s=n.querySelector(".loader");let l=512,u=512;function d(e){const t=Array.prototype.slice.call(arguments,1);for(let n=0;n<e.length;++n)e[n].apply(null,t)}function r(){const e=i.getBoundingClientRect();return[Math.floor(e.width),Math.floor(e.height)]}!function(){function e(e){document.body.style.overflow=e?"hidden":"auto"}const n=t("side-pane-checkbox-id");o&&(window.addEventListener("load",function(){e(o.checked),o.addEventListener("change",function(){e(o.checked)})},!1),n&&o.addEventListener("change",function(){o.checked&&(n.checked=!1)},!1))}();let a=[0,0];const f=[];function h(e){return e+"px"}function g(){n.style.width="100vw";const e=r();o.checked?(n.style.height="100%",n.style["max-width"]="",n.style["max-height"]=""):(e[1]=e[0]*u/l,n.style.height=h(e[1]),n.style["max-width"]=h(l),n.style["max-height"]=h(u)),e[0]===a[0]&&e[1]===a[1]||(a=r(),d(f,a[0],a[1]))}window.addEventListener("load",g,!1),o.addEventListener("change",g,!1),window.addEventListener("resize",g,!1);const v=[];let m=!1;const w=[g],y=[],E=[],p=[],L=[],b=[],k=[],Y=[];if(o&&o.addEventListener("change",function(){d(w,o.checked)},!1),i){function X(e,t){const n=i.getBoundingClientRect();return[(e-n.left)/n.width,(t-n.top)/n.height]}function x(e,t){const n=X(e,t);v[0]=n[0],v[1]=n[1],m=!0,d(y)}function C(){m&&(m=!1,d(k))}function M(e,t){const n=X(e,t),i=n[0]-v[0],c=n[1]-v[1];v[0]=n[0],v[1]=n[1],m&&d(E,i,c),d(b,n[0],n[1])}i.addEventListener("mousedown",function(e){0===e.button&&x(e.clientX,e.clientY)},!1),i.addEventListener("mouseenter",function(){d(p)},!1),i.addEventListener("mouseleave",function(){d(L)},!1),i.addEventListener("wheel",function(e){if(Y.length>0){const t=e.deltaY>0?1:-1;return d(Y,t,v),e.preventDefault(),!1}return!0},!1),window.addEventListener("mousemove",function(e){M(e.clientX,e.clientY)}),window.addEventListener("mouseup",function(e){0===e.button&&C()});const e=[];let t=0;i.addEventListener("touchstart",function(n){const i=e.length,c=n.changedTouches;for(let t=0;t<c.length;++t){const n=c[t];let i=!1;for(let t=0;t<e.length;++t)if(n.identifier===e[t].id){i=!0;break}i||e.push({id:n.identifier,clientX:n.clientX,clientY:n.clientY})}if(0===i&&e.length>0){const t=e[0];x(t.clientX,t.clientY)}else if(2===e.length){const n=e[0],i=e[1],c=n.clientX-i.clientX,o=n.clientY-i.clientY;t=Math.sqrt(c*c+o*o)}},!1),window.addEventListener("touchend",function(t){const n=t.changedTouches;for(let t=0;t<n.length;++t){const i=n[t];for(let t=0;t<e.length;++t)i.identifier===e[t].id&&(e.splice(t,1),t--)}if(1===e.length){const t=X(e[0].clientX,e[0].clientY);v[0]=t[0],v[1]=t[1]}else 0===e.length&&C()}),window.addEventListener("touchmove",function(n){const i=n.changedTouches;for(let t=0;t<i.length;++t){const n=i[t];for(let t=0;t<e.length;++t)n.identifier===e[t].id&&(e[t].clientX=n.clientX,e[t].clientY=n.clientY)}if(m&&Y.length>0&&n.preventDefault(),1===e.length)M(e[0].clientX,e[0].clientY);else if(2===e.length){const n=e[0],i=e[1],c=n.clientX-i.clientX,o=n.clientY-i.clientY,s=Math.sqrt(c*c+o*o),l=(t-s)/t;t=s;const u=X(.5*(e[0].clientX+e[1].clientX),.5*(e[0].clientY+e[1].clientY));d(Y,5*l,u)}},{passive:!1})}const T={};return Object.freeze({Observers:Object.freeze({canvasResize:f,fullscreenToggle:w,mouseDown:y,mouseDrag:E,mouseEnter:p,mouseLeave:L,mouseMove:b,mouseWheel:Y,mouseUp:k}),getAspectRatio:function(){const e=r();return e[0]/e[1]},getCanvas:function(){return i},getCanvasContainer:function(){return n},getSize:r,getMousePosition:function(){return v.slice()},isFullScreen:function(){return o&&o.checked},isMouseDown:function(){return m},setIndicatorText:function(t,n){const i=function(t){if(!T[t]){const n=t+"-indicator-id";T[t]=e("#"+n+" span")}return T[t]}(t);i&&(i.innerText=n)},setIndicatorsVisibility:function(e){document.getElementById("indicators").style.display=e?"block":"none"},setMaxSize:function(e,t){l=e,u=t,g()},setResizable:function(e){c.style.display=e?"block":"none"},setLoaderText:function(e){s&&(s.querySelector("span").innerText=e)},showLoader:function(e){s&&(s.style.display=e?"block":"")},toggleFullscreen:function(e){if(o){if(e!=o.checked)if(o.checked=e,"function"==typeof window.CustomEvent)o.dispatchEvent(new CustomEvent("change"));else if("function"==typeof CustomEvent.prototype.initCustomEvent){const e=document.createEvent("CustomEvent");e.initCustomEvent("change",!1,!1,void 0),o.dispatchEvent(e)}}}})}();