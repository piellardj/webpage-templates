var Page;!function(l){!function(e){var t,i,a;function s(e){this.queryParameters={};var t=e.indexOf(s.queryDelimiter);if(t<0)this.baseUrl=e;else{this.baseUrl=e.substring(0,t);for(var r=0,n=e.substring(t+s.queryDelimiter.length).split(s.parameterDelimiter);r<n.length;r++){var i,a=n[r],o=a.split(s.keyValueDelimiter);2===o.length?(i=decodeURIComponent(o[0]),o=decodeURIComponent(o[1]),this.queryParameters[i]=o):console.log("Unable to parse query string parameter '"+a+"'.")}}}function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.join(":")+":"}function c(e){window.history.replaceState("","",e)}function r(e,t){this.objectsName=e,this.loadObjectsFunction=t,this.cacheObject=null}function n(e,t,r){this.prefix=e,this.serialize=t,this.tryDeserialize=r}(t=e.Utils||(e.Utils={})).selectorAll=function(e,t){for(var r=e.querySelectorAll(t),n=[],i=0;i<r.length;i++)n.push(r[i]);return n},t.selector=function(e,t){if(e=e.querySelector(t))return e;throw new Error("No element matching '".concat(t,"'."))},t.touchArray=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t},t.findFirst=function(e,t){if("function"==typeof Array.prototype.findIndex)return e.findIndex(t);for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1},t=e.URL||(e.URL={}),i="page",s.prototype.setQueryParameter=function(e,t){null===t?delete this.queryParameters[e]:this.queryParameters[e]=t},s.prototype.loopOnParameters=function(e,t){for(var r=0,n=Object.keys(this.queryParameters);r<n.length;r++){var i,a=n[r];0===a.indexOf(e)&&a.length>e.length&&(i=this.queryParameters[a],t(a.substring(e.length),i))}},s.prototype.buildUrl=function(){for(var e=[],t=0,r=Object.keys(this.queryParameters);t<r.length;t++){var n=r[t],i=this.queryParameters[n],n=encodeURIComponent(n),i=encodeURIComponent(i);e.push(n+s.keyValueDelimiter+i)}var a=e.join(s.parameterDelimiter);return a?this.baseUrl+s.queryDelimiter+a:this.baseUrl},s.queryDelimiter="?",s.parameterDelimiter="&",s.keyValueDelimiter="=",a=s,t.loopOnParameters=function(e,t){var r=new a(window.location.href),e=o(i,e);r.loopOnParameters(e,t)},t.setQueryParameter=function(e,t,r){var n=new a(window.location.href),e=o(i,e);n.setQueryParameter(e+t,r),c(n.buildUrl())},t.removeQueryParameter=function(e,t){var r=new a(window.location.href),e=o(i,e);r.setQueryParameter(e+t,null),c(r.buildUrl())},(e.Events||(e.Events={})).callAfterDOMLoaded=function(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()},r.prototype.getById=function(e){var t=this.safeCacheObject[e];if(t)return t;throw new Error("Invalid '".concat(this.objectsName,"' cache object id '").concat(e,"'."))},r.prototype.getByIdSafe=function(e){return this.safeCacheObject[e]||null},r.prototype.load=function(){this.cacheObject||(this.cacheObject=this.loadCacheObject())},Object.defineProperty(r.prototype,"safeCacheObject",{get:function(){return this.cacheObject||this.load(),this.cacheObject},enumerable:!1,configurable:!0}),r.prototype.loadCacheObject=function(){for(var e={},t=0,r=this.loadObjectsFunction();t<r.length;t++){var n=r[t];if(void 0!==e[n.id])throw new Error("Object '".concat(n.id,"' is already in cache."));e[n.id]=n}return e},e.Cache=r,n.prototype.storeState=function(e){var t=this.serialize(e);l.Helpers.URL.setQueryParameter(this.prefix,e.id,t)},n.prototype.clearStoredState=function(e){l.Helpers.URL.removeQueryParameter(this.prefix,e.id)},n.prototype.applyStoredState=function(){var r=this;l.Helpers.URL.loopOnParameters(this.prefix,function(e,t){r.tryDeserialize(e,t)||(console.log("Removing invalid query parameter '"+e+"="+t+"'."),l.Helpers.URL.removeQueryParameter(r.prefix,e))})},e.Storage=n}(l.Helpers||(l.Helpers={}))}(Page=Page||{});