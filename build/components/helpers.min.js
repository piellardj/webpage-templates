var Page;!function(l){!function(e){var t,i,n;function s(e){this.queryParameters={};var t=e.indexOf(s.queryDelimiter);if(t<0)this.baseUrl=e;else{this.baseUrl=e.substring(0,t);for(var r=0,a=e.substring(t+s.queryDelimiter.length).split(s.parameterDelimiter);r<a.length;r++){var i,n=a[r],o=n.split(s.keyValueDelimiter);2===o.length?(i=decodeURIComponent(o[0]),o=decodeURIComponent(o[1]),this.queryParameters[i]=o):console.log("Unable to parse query string parameter '"+n+"'.")}}}function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.join(":")+":"}function c(e){window.history.replaceState("","",e)}function r(e,t){this.objectsName=e,this.loadObjectsFunction=t,this.cacheObject=null}function a(e,t,r){this.prefix=e,this.serialize=t,this.tryDeserialize=r}t=e.URL||(e.URL={}),i="page",s.prototype.setQueryParameter=function(e,t){null===t?delete this.queryParameters[e]:this.queryParameters[e]=t},s.prototype.loopOnParameters=function(e,t){for(var r=0,a=Object.keys(this.queryParameters);r<a.length;r++){var i,n=a[r];0===n.indexOf(e)&&n.length>e.length&&(i=this.queryParameters[n],t(n.substring(e.length),i))}},s.prototype.buildUrl=function(){for(var e=[],t=0,r=Object.keys(this.queryParameters);t<r.length;t++){var a=r[t],i=this.queryParameters[a],a=encodeURIComponent(a),i=encodeURIComponent(i);e.push(a+s.keyValueDelimiter+i)}var n=e.join(s.parameterDelimiter);return n?this.baseUrl+s.queryDelimiter+n:this.baseUrl},s.queryDelimiter="?",s.parameterDelimiter="&",s.keyValueDelimiter="=",n=s,t.loopOnParameters=function(e,t){var r=new n(window.location.href),e=o(i,e);r.loopOnParameters(e,t)},t.setQueryParameter=function(e,t,r){var a=new n(window.location.href),e=o(i,e);a.setQueryParameter(e+t,r),c(a.buildUrl())},t.removeQueryParameter=function(e,t){var r=new n(window.location.href),e=o(i,e);r.setQueryParameter(e+t,null),c(r.buildUrl())},(e.Events||(e.Events={})).callAfterDOMLoaded=function(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()},r.prototype.getById=function(e){var t=this.safeCacheObject[e];if(t)return t;throw new Error("Invalid '".concat(this.objectsName,"' cache object id '").concat(e,"'."))},r.prototype.getByIdSafe=function(e){return this.safeCacheObject[e]||null},r.prototype.load=function(){this.cacheObject||(this.cacheObject=this.loadCacheObject())},Object.defineProperty(r.prototype,"safeCacheObject",{get:function(){return this.cacheObject||this.load(),this.cacheObject},enumerable:!1,configurable:!0}),r.prototype.loadCacheObject=function(){for(var e={},t=0,r=this.loadObjectsFunction();t<r.length;t++){var a=r[t];if(void 0!==e[a.id])throw new Error("Object '".concat(a.id,"' is already in cache."));e[a.id]=a}return e},e.Cache=r,a.prototype.storeState=function(e){var t=this.serialize(e);l.Helpers.URL.setQueryParameter(this.prefix,e.id,t)},a.prototype.clearStoredState=function(e){l.Helpers.URL.removeQueryParameter(this.prefix,e.id)},a.prototype.applyStoredState=function(){var r=this;l.Helpers.URL.loopOnParameters(this.prefix,function(e,t){r.tryDeserialize(e,t)||(console.log("Removing invalid query parameter '"+e+"="+t+"'."),l.Helpers.URL.removeQueryParameter(r.prefix,e))})},e.Storage=a}(l.Helpers||(l.Helpers={}))}(Page=Page||{});